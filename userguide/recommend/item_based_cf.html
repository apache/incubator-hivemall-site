
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Item-based Collaborative Filtering Â· Hivemall User Manual</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-etoc/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-callouts/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-toggle-chapters/toggle.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-codeblock-filename/block.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-multipart/multipart.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-emphasize/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-api/theme-api.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="news20.html" />
    
    
    <link rel="prev" href="cf.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://hivemall.incubator.apache.org/" target="_blank" class="custom-link"><i class="fa fa-home"></i> Home</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        <li class="header">TABLE OF CONTENTS</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                        <b>1.1.</b>
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../getting_started/">
            
                <a href="../getting_started/">
            
                    
                        <b>1.2.</b>
                    
                    Getting Started
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../getting_started/installation.html">
            
                <a href="../getting_started/installation.html">
            
                    
                        <b>1.2.1.</b>
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../getting_started/permanent-functions.html">
            
                <a href="../getting_started/permanent-functions.html">
            
                    
                        <b>1.2.2.</b>
                    
                    Install as permanent functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../getting_started/input-format.html">
            
                <a href="../getting_started/input-format.html">
            
                    
                        <b>1.2.3.</b>
                    
                    Input Format
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../misc/funcs.html">
            
                <a href="../misc/funcs.html">
            
                    
                        <b>1.3.</b>
                    
                    List of Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../tips/">
            
                <a href="../tips/">
            
                    
                        <b>1.4.</b>
                    
                    Tips for Effective Hivemall
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../tips/addbias.html">
            
                <a href="../tips/addbias.html">
            
                    
                        <b>1.4.1.</b>
                    
                    Explicit add_bias() for better prediction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../tips/rand_amplify.html">
            
                <a href="../tips/rand_amplify.html">
            
                    
                        <b>1.4.2.</b>
                    
                    Use rand_amplify() to better prediction results
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../tips/rt_prediction.html">
            
                <a href="../tips/rt_prediction.html">
            
                    
                        <b>1.4.3.</b>
                    
                    Real-time prediction on RDBMS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../tips/ensemble_learning.html">
            
                <a href="../tips/ensemble_learning.html">
            
                    
                        <b>1.4.4.</b>
                    
                    Ensemble learning for stable prediction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../tips/mixserver.html">
            
                <a href="../tips/mixserver.html">
            
                    
                        <b>1.4.5.</b>
                    
                    Mixing models for a better prediction convergence (MIX server)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../tips/emr.html">
            
                <a href="../tips/emr.html">
            
                    
                        <b>1.4.6.</b>
                    
                    Run Hivemall on Amazon Elastic MapReduce
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../tips/general_tips.html">
            
                <a href="../tips/general_tips.html">
            
                    
                        <b>1.5.</b>
                    
                    General Hive/Hadoop Tips
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../tips/rowid.html">
            
                <a href="../tips/rowid.html">
            
                    
                        <b>1.5.1.</b>
                    
                    Adding rowid for each row
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../tips/hadoop_tuning.html">
            
                <a href="../tips/hadoop_tuning.html">
            
                    
                        <b>1.5.2.</b>
                    
                    Hadoop tuning for Hivemall
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../troubleshooting/">
            
                <a href="../troubleshooting/">
            
                    
                        <b>1.6.</b>
                    
                    Troubleshooting
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../troubleshooting/oom.html">
            
                <a href="../troubleshooting/oom.html">
            
                    
                        <b>1.6.1.</b>
                    
                    OutOfMemoryError in training
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../troubleshooting/mapjoin_task_error.html">
            
                <a href="../troubleshooting/mapjoin_task_error.html">
            
                    
                        <b>1.6.2.</b>
                    
                    SemanticException generate map join task error: Cannot serialize object
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../troubleshooting/asterisk.html">
            
                <a href="../troubleshooting/asterisk.html">
            
                    
                        <b>1.6.3.</b>
                    
                    Asterisk argument for UDTF does not work
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../troubleshooting/num_mappers.html">
            
                <a href="../troubleshooting/num_mappers.html">
            
                    
                        <b>1.6.4.</b>
                    
                    The number of mappers is less than input splits in Hadoop 2.x
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../troubleshooting/mapjoin_classcastex.html">
            
                <a href="../troubleshooting/mapjoin_classcastex.html">
            
                    
                        <b>1.6.5.</b>
                    
                    Map-side join causes ClassCastException on Tez
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part II - Generic Features</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../misc/generic_funcs.html">
            
                <a href="../misc/generic_funcs.html">
            
                    
                        <b>2.1.</b>
                    
                    List of Generic Hivemall Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../misc/topk.html">
            
                <a href="../misc/topk.html">
            
                    
                        <b>2.2.</b>
                    
                    Efficient Top-K Query Processing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../misc/tokenizer.html">
            
                <a href="../misc/tokenizer.html">
            
                    
                        <b>2.3.</b>
                    
                    Text Tokenizer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../misc/approx.html">
            
                <a href="../misc/approx.html">
            
                    
                        <b>2.4.</b>
                    
                    Approximate Aggregate Functions
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part III - Feature Engineering</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../ft_engineering/scaling.html">
            
                <a href="../ft_engineering/scaling.html">
            
                    
                        <b>3.1.</b>
                    
                    Feature Scaling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../ft_engineering/hashing.html">
            
                <a href="../ft_engineering/hashing.html">
            
                    
                        <b>3.2.</b>
                    
                    Feature Hashing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../ft_engineering/selection.html">
            
                <a href="../ft_engineering/selection.html">
            
                    
                        <b>3.3.</b>
                    
                    Feature Selection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../ft_engineering/binning.html">
            
                <a href="../ft_engineering/binning.html">
            
                    
                        <b>3.4.</b>
                    
                    Feature Binning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="../ft_engineering/pairing.html">
            
                <a href="../ft_engineering/pairing.html">
            
                    
                        <b>3.5.</b>
                    
                    Feature Paring
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.5.1" data-path="../ft_engineering/polynomial.html">
            
                <a href="../ft_engineering/polynomial.html">
            
                    
                        <b>3.5.1.</b>
                    
                    Polynomial features
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="../ft_engineering/ft_trans.html">
            
                <a href="../ft_engineering/ft_trans.html">
            
                    
                        <b>3.6.</b>
                    
                    Feature Transformation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.6.1" data-path="../ft_engineering/vectorization.html">
            
                <a href="../ft_engineering/vectorization.html">
            
                    
                        <b>3.6.1.</b>
                    
                    Feature vectorization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6.2" data-path="../ft_engineering/quantify.html">
            
                <a href="../ft_engineering/quantify.html">
            
                    
                        <b>3.6.2.</b>
                    
                    Quantify non-number features
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6.3" data-path="../ft_engineering/binarize.html">
            
                <a href="../ft_engineering/binarize.html">
            
                    
                        <b>3.6.3.</b>
                    
                    Binarize label
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="../ft_engineering/term_vector.html">
            
                <a href="../ft_engineering/term_vector.html">
            
                    
                        <b>3.7.</b>
                    
                    Term Vector Model
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.7.1" data-path="../ft_engineering/tfidf.html">
            
                <a href="../ft_engineering/tfidf.html">
            
                    
                        <b>3.7.1.</b>
                    
                    TF-IDF Term Weighting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.7.2" data-path="../ft_engineering/bm25.html">
            
                <a href="../ft_engineering/bm25.html">
            
                    
                        <b>3.7.2.</b>
                    
                    Okapi BM25 Term Weighting
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part IV - Evaluation</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../eval/binary_classification_measures.html">
            
                <a href="../eval/binary_classification_measures.html">
            
                    
                        <b>4.1.</b>
                    
                    Binary Classification Metrics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../eval/auc.html">
            
                <a href="../eval/auc.html">
            
                    
                        <b>4.1.1.</b>
                    
                    Area under the ROC curve
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../eval/multilabel_classification_measures.html">
            
                <a href="../eval/multilabel_classification_measures.html">
            
                    
                        <b>4.2.</b>
                    
                    Multi-label Classification Metrics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../eval/regression.html">
            
                <a href="../eval/regression.html">
            
                    
                        <b>4.3.</b>
                    
                    Regression Metrics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="../eval/rank.html">
            
                <a href="../eval/rank.html">
            
                    
                        <b>4.4.</b>
                    
                    Ranking Measures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="../eval/datagen.html">
            
                <a href="../eval/datagen.html">
            
                    
                        <b>4.5.</b>
                    
                    Data Generation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.5.1" data-path="../eval/lr_datagen.html">
            
                <a href="../eval/lr_datagen.html">
            
                    
                        <b>4.5.1.</b>
                    
                    Logistic Regression data generation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part V - Supervised Learning</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../supervised_learning/prediction.html">
            
                <a href="../supervised_learning/prediction.html">
            
                    
                        <b>5.1.</b>
                    
                    How Prediction Works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../supervised_learning/tutorial.html">
            
                <a href="../supervised_learning/tutorial.html">
            
                    
                        <b>5.2.</b>
                    
                    Step-by-Step Tutorial on Supervised Learning
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part VI - Binary Classification</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../binaryclass/general.html">
            
                <a href="../binaryclass/general.html">
            
                    
                        <b>6.1.</b>
                    
                    Binary Classification
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../binaryclass/a9a.html">
            
                <a href="../binaryclass/a9a.html">
            
                    
                        <b>6.2.</b>
                    
                    a9a Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.2.1" data-path="../binaryclass/a9a_dataset.html">
            
                <a href="../binaryclass/a9a_dataset.html">
            
                    
                        <b>6.2.1.</b>
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2.2" data-path="../binaryclass/a9a_generic.html">
            
                <a href="../binaryclass/a9a_generic.html">
            
                    
                        <b>6.2.2.</b>
                    
                    General Binary Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2.3" data-path="../binaryclass/a9a_lr.html">
            
                <a href="../binaryclass/a9a_lr.html">
            
                    
                        <b>6.2.3.</b>
                    
                    Logistic Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2.4" data-path="../binaryclass/a9a_minibatch.html">
            
                <a href="../binaryclass/a9a_minibatch.html">
            
                    
                        <b>6.2.4.</b>
                    
                    Mini-batch Gradient Descent
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="../binaryclass/news20.html">
            
                <a href="../binaryclass/news20.html">
            
                    
                        <b>6.3.</b>
                    
                    News20 Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.3.1" data-path="../binaryclass/news20_dataset.html">
            
                <a href="../binaryclass/news20_dataset.html">
            
                    
                        <b>6.3.1.</b>
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.2" data-path="../binaryclass/news20_pa.html">
            
                <a href="../binaryclass/news20_pa.html">
            
                    
                        <b>6.3.2.</b>
                    
                    Perceptron, Passive Aggressive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.3" data-path="../binaryclass/news20_scw.html">
            
                <a href="../binaryclass/news20_scw.html">
            
                    
                        <b>6.3.3.</b>
                    
                    CW, AROW, SCW
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.4" data-path="../binaryclass/news20_generic.html">
            
                <a href="../binaryclass/news20_generic.html">
            
                    
                        <b>6.3.4.</b>
                    
                    General Binary Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.5" data-path="../binaryclass/news20_adagrad.html">
            
                <a href="../binaryclass/news20_adagrad.html">
            
                    
                        <b>6.3.5.</b>
                    
                    AdaGradRDA, AdaGrad, AdaDelta
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.6" data-path="../binaryclass/news20_rf.html">
            
                <a href="../binaryclass/news20_rf.html">
            
                    
                        <b>6.3.6.</b>
                    
                    Random Forest
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="../binaryclass/kdd2010a.html">
            
                <a href="../binaryclass/kdd2010a.html">
            
                    
                        <b>6.4.</b>
                    
                    KDD2010a Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.4.1" data-path="../binaryclass/kdd2010a_dataset.html">
            
                <a href="../binaryclass/kdd2010a_dataset.html">
            
                    
                        <b>6.4.1.</b>
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4.2" data-path="../binaryclass/kdd2010a_scw.html">
            
                <a href="../binaryclass/kdd2010a_scw.html">
            
                    
                        <b>6.4.2.</b>
                    
                    PA, CW, AROW, SCW
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.5" data-path="../binaryclass/kdd2010b.html">
            
                <a href="../binaryclass/kdd2010b.html">
            
                    
                        <b>6.5.</b>
                    
                    KDD2010b Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.5.1" data-path="../binaryclass/kdd2010b_dataset.html">
            
                <a href="../binaryclass/kdd2010b_dataset.html">
            
                    
                        <b>6.5.1.</b>
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.5.2" data-path="../binaryclass/kdd2010b_arow.html">
            
                <a href="../binaryclass/kdd2010b_arow.html">
            
                    
                        <b>6.5.2.</b>
                    
                    AROW
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.6" data-path="../binaryclass/webspam.html">
            
                <a href="../binaryclass/webspam.html">
            
                    
                        <b>6.6.</b>
                    
                    Webspam Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.6.1" data-path="../binaryclass/webspam_dataset.html">
            
                <a href="../binaryclass/webspam_dataset.html">
            
                    
                        <b>6.6.1.</b>
                    
                    Data Pareparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.6.2" data-path="../binaryclass/webspam_scw.html">
            
                <a href="../binaryclass/webspam_scw.html">
            
                    
                        <b>6.6.2.</b>
                    
                    PA1, AROW, SCW
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.7" data-path="../binaryclass/titanic_rf.html">
            
                <a href="../binaryclass/titanic_rf.html">
            
                    
                        <b>6.7.</b>
                    
                    Kaggle Titanic Tutorial
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.8" data-path="../binaryclass/criteo.html">
            
                <a href="../binaryclass/criteo.html">
            
                    
                        <b>6.8.</b>
                    
                    Criteo Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.8.1" data-path="../binaryclass/criteo_dataset.html">
            
                <a href="../binaryclass/criteo_dataset.html">
            
                    
                        <b>6.8.1.</b>
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.8.2" data-path="../binaryclass/criteo_ffm.html">
            
                <a href="../binaryclass/criteo_ffm.html">
            
                    
                        <b>6.8.2.</b>
                    
                    Field-Aware Factorization Machines
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part VII - Multiclass Classification</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../multiclass/news20.html">
            
                <a href="../multiclass/news20.html">
            
                    
                        <b>7.1.</b>
                    
                    News20 Multiclass Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.1" data-path="../multiclass/news20_dataset.html">
            
                <a href="../multiclass/news20_dataset.html">
            
                    
                        <b>7.1.1.</b>
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2" data-path="../multiclass/news20_one-vs-the-rest_dataset.html">
            
                <a href="../multiclass/news20_one-vs-the-rest_dataset.html">
            
                    
                        <b>7.1.2.</b>
                    
                    Data Preparation for one-vs-the-rest classifiers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.3" data-path="../multiclass/news20_pa.html">
            
                <a href="../multiclass/news20_pa.html">
            
                    
                        <b>7.1.3.</b>
                    
                    PA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.4" data-path="../multiclass/news20_scw.html">
            
                <a href="../multiclass/news20_scw.html">
            
                    
                        <b>7.1.4.</b>
                    
                    CW, AROW, SCW
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.5" data-path="../multiclass/news20_ensemble.html">
            
                <a href="../multiclass/news20_ensemble.html">
            
                    
                        <b>7.1.5.</b>
                    
                    Ensemble learning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.6" data-path="../multiclass/news20_one-vs-the-rest.html">
            
                <a href="../multiclass/news20_one-vs-the-rest.html">
            
                    
                        <b>7.1.6.</b>
                    
                    one-vs-the-rest Classifier
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="../multiclass/iris.html">
            
                <a href="../multiclass/iris.html">
            
                    
                        <b>7.2.</b>
                    
                    Iris Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.2.1" data-path="../multiclass/iris_dataset.html">
            
                <a href="../multiclass/iris_dataset.html">
            
                    
                        <b>7.2.1.</b>
                    
                    Data preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2.2" data-path="../multiclass/iris_scw.html">
            
                <a href="../multiclass/iris_scw.html">
            
                    
                        <b>7.2.2.</b>
                    
                    SCW
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2.3" data-path="../multiclass/iris_randomforest.html">
            
                <a href="../multiclass/iris_randomforest.html">
            
                    
                        <b>7.2.3.</b>
                    
                    Random Forest
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part VIII - Regression</li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="../regression/general.html">
            
                <a href="../regression/general.html">
            
                    
                        <b>8.1.</b>
                    
                    Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="../regression/e2006.html">
            
                <a href="../regression/e2006.html">
            
                    
                        <b>8.2.</b>
                    
                    E2006-tfidf Regression Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.2.1" data-path="../regression/e2006_dataset.html">
            
                <a href="../regression/e2006_dataset.html">
            
                    
                        <b>8.2.1.</b>
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2.2" data-path="../regression/e2006_generic.html">
            
                <a href="../regression/e2006_generic.html">
            
                    
                        <b>8.2.2.</b>
                    
                    General Regessor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2.3" data-path="../regression/e2006_arow.html">
            
                <a href="../regression/e2006_arow.html">
            
                    
                        <b>8.2.3.</b>
                    
                    Passive Aggressive, AROW
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="../regression/kddcup12tr2.html">
            
                <a href="../regression/kddcup12tr2.html">
            
                    
                        <b>8.3.</b>
                    
                    KDDCup 2012 Track 2 CTR Prediction Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.3.1" data-path="../regression/kddcup12tr2_dataset.html">
            
                <a href="../regression/kddcup12tr2_dataset.html">
            
                    
                        <b>8.3.1.</b>
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.2" data-path="../regression/kddcup12tr2_lr.html">
            
                <a href="../regression/kddcup12tr2_lr.html">
            
                    
                        <b>8.3.2.</b>
                    
                    Logistic Regression, Passive Aggressive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.3" data-path="../regression/kddcup12tr2_lr_amplify.html">
            
                <a href="../regression/kddcup12tr2_lr_amplify.html">
            
                    
                        <b>8.3.3.</b>
                    
                    Logistic Regression with amplifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.4" data-path="../regression/kddcup12tr2_adagrad.html">
            
                <a href="../regression/kddcup12tr2_adagrad.html">
            
                    
                        <b>8.3.4.</b>
                    
                    AdaGrad, AdaDelta
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part IX - Recommendation</li>
        
        
    
        <li class="chapter " data-level="9.1" data-path="cf.html">
            
                <a href="cf.html">
            
                    
                        <b>9.1.</b>
                    
                    Collaborative Filtering
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="9.1.1" data-path="item_based_cf.html">
            
                <a href="item_based_cf.html">
            
                    
                        <b>9.1.1.</b>
                    
                    Item-based Collaborative Filtering
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="news20.html">
            
                <a href="news20.html">
            
                    
                        <b>9.2.</b>
                    
                    News20 Related Article Recommendation Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.2.1" data-path="../multiclass/news20_dataset.html">
            
                <a href="../multiclass/news20_dataset.html">
            
                    
                        <b>9.2.1.</b>
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.2.2" data-path="news20_jaccard.html">
            
                <a href="news20_jaccard.html">
            
                    
                        <b>9.2.2.</b>
                    
                    LSH/MinHash and Jaccard Similarity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.2.3" data-path="news20_knn.html">
            
                <a href="news20_knn.html">
            
                    
                        <b>9.2.3.</b>
                    
                    LSH/MinHash and Brute-force Search
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.2.4" data-path="news20_bbit_minhash.html">
            
                <a href="news20_bbit_minhash.html">
            
                    
                        <b>9.2.4.</b>
                    
                    kNN search using b-Bits MinHash
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="movielens.html">
            
                <a href="movielens.html">
            
                    
                        <b>9.3.</b>
                    
                    MovieLens Movie Recommendation Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.3.1" data-path="movielens_dataset.html">
            
                <a href="movielens_dataset.html">
            
                    
                        <b>9.3.1.</b>
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.3.2" data-path="movielens_cf.html">
            
                <a href="movielens_cf.html">
            
                    
                        <b>9.3.2.</b>
                    
                    Item-based Collaborative Filtering
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.3.3" data-path="movielens_mf.html">
            
                <a href="movielens_mf.html">
            
                    
                        <b>9.3.3.</b>
                    
                    Matrix Factorization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.3.4" data-path="movielens_fm.html">
            
                <a href="movielens_fm.html">
            
                    
                        <b>9.3.4.</b>
                    
                    Factorization Machine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.3.5" data-path="movielens_slim.html">
            
                <a href="movielens_slim.html">
            
                    
                        <b>9.3.5.</b>
                    
                    SLIM for fast top-k Recommendation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.3.6" data-path="movielens_cv.html">
            
                <a href="movielens_cv.html">
            
                    
                        <b>9.3.6.</b>
                    
                    10-fold Cross Validation (Matrix Factorization)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part X - Anomaly Detection</li>
        
        
    
        <li class="chapter " data-level="10.1" data-path="../anomaly/lof.html">
            
                <a href="../anomaly/lof.html">
            
                    
                        <b>10.1.</b>
                    
                    Outlier Detection using Local Outlier Factor (LOF)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.2" data-path="../anomaly/sst.html">
            
                <a href="../anomaly/sst.html">
            
                    
                        <b>10.2.</b>
                    
                    Change-Point Detection using Singular Spectrum Transformation (SST)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.3" data-path="../anomaly/changefinder.html">
            
                <a href="../anomaly/changefinder.html">
            
                    
                        <b>10.3.</b>
                    
                    ChangeFinder: Detecting Outlier and Change-Point Simultaneously
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part XI - Clustering</li>
        
        
    
        <li class="chapter " data-level="11.1" data-path="../clustering/lda.html">
            
                <a href="../clustering/lda.html">
            
                    
                        <b>11.1.</b>
                    
                    Latent Dirichlet Allocation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.2" data-path="../clustering/plsa.html">
            
                <a href="../clustering/plsa.html">
            
                    
                        <b>11.2.</b>
                    
                    Probabilistic Latent Semantic Analysis
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part XII - GeoSpatial Functions</li>
        
        
    
        <li class="chapter " data-level="12.1" data-path="../geospatial/latlon.html">
            
                <a href="../geospatial/latlon.html">
            
                    
                        <b>12.1.</b>
                    
                    Lat/Lon functions
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part XIII - Hivemall on Spark</li>
        
        
    
        <li class="chapter " data-level="13.1" data-path="../spark/getting_started/">
            
                <a href="../spark/getting_started/">
            
                    
                        <b>13.1.</b>
                    
                    Getting Started
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="13.1.1" data-path="../spark/getting_started/installation.html">
            
                <a href="../spark/getting_started/installation.html">
            
                    
                        <b>13.1.1.</b>
                    
                    Installation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="13.2" data-path="../spark/binaryclass/">
            
                <a href="../spark/binaryclass/">
            
                    
                        <b>13.2.</b>
                    
                    Binary Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="13.2.1" data-path="../spark/binaryclass/a9a_df.html">
            
                <a href="../spark/binaryclass/a9a_df.html">
            
                    
                        <b>13.2.1.</b>
                    
                    a9a Tutorial for DataFrame
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="13.2.2" data-path="../spark/binaryclass/a9a_sql.html">
            
                <a href="../spark/binaryclass/a9a_sql.html">
            
                    
                        <b>13.2.2.</b>
                    
                    a9a Tutorial for SQL
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="13.3" data-path="../spark/binaryclass/">
            
                <a href="../spark/binaryclass/">
            
                    
                        <b>13.3.</b>
                    
                    Regression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="13.3.1" data-path="../spark/regression/e2006_df.html">
            
                <a href="../spark/regression/e2006_df.html">
            
                    
                        <b>13.3.1.</b>
                    
                    E2006-tfidf Regression Tutorial for DataFrame
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="13.3.2" data-path="../spark/regression/e2006_sql.html">
            
                <a href="../spark/regression/e2006_sql.html">
            
                    
                        <b>13.3.2.</b>
                    
                    E2006-tfidf Regression Tutorial for SQL
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="13.4" data-path="../spark/misc/misc.html">
            
                <a href="../spark/misc/misc.html">
            
                    
                        <b>13.4.</b>
                    
                    Generic Features
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="13.4.1" data-path="../spark/misc/topk_join.html">
            
                <a href="../spark/misc/topk_join.html">
            
                    
                        <b>13.4.1.</b>
                    
                    Top-k Join Processing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="13.4.2" data-path="../spark/misc/functions.html">
            
                <a href="../spark/misc/functions.html">
            
                    
                        <b>13.4.2.</b>
                    
                    Other Utility Functions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part XIV - Hivemall on Docker</li>
        
        
    
        <li class="chapter " data-level="14.1" data-path="../docker/getting_started.html">
            
                <a href="../docker/getting_started.html">
            
                    
                        <b>14.1.</b>
                    
                    Getting Started
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part XIV - External References</li>
        
        
    
        <li class="chapter " data-level="15.1" >
            
                <a target="_blank" href="https://github.com/daijyc/hivemall/wiki/PigHome">
            
                    
                        <b>15.1.</b>
                    
                    Hivemall on Apache Pig
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Item-based Collaborative Filtering</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <!--
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing,
  software distributed under the License is distributed on an
  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, either express or implied.  See the License for the
  specific language governing permissions and limitations
  under the License.
-->
<p>This document describes how to do Item-based Collaborative Filtering using Hivemall.</p>
<!-- toc --><div id="toc" class="toc">

<ul>
<li><a href="#prepare-transaction-table">Prepare <code>transaction</code> table</a></li>
<li><a href="#create-itemfeatures-table">Create <code>item_features</code> table</a><ul>
<li><a href="#step-1-creating-userpurchased-table">Step 1: Creating <code>user_purchased</code> table</a></li>
<li><a href="#step-2-creating-cooccurrence-table">Step 2: Creating <code>cooccurrence</code> table</a><ul>
<li><a href="#step-2-1-create-cooccurrence-table-directly">Step 2-1: Create <code>cooccurrence</code> table directly</a></li>
<li><a href="#step-2-2-create-cooccurrence-table-from-upper-triangular-matrix-of-cooccurrence">Step 2-2: Create <code>cooccurrence</code> table from Upper Triangular Matrix of cooccurrence</a></li>
<li><a href="#computing-cooccurrence-ratio-optional-step">Computing cooccurrence ratio (optional step)</a></li>
</ul>
</li>
<li><a href="#step-3-creating-a-feature-vector-for-each-item">Step 3: Creating a feature vector for each item</a></li>
</ul>
</li>
<li><a href="#compute-item-similarity-scores">Compute item similarity scores</a><ul>
<li><a href="#option-1-parallel-computation-with-computationally-heavy-shuffling">Option 1: Parallel computation with computationally heavy shuffling</a><ul>
<li><a href="#taking-advantage-of-the-symmetric-property-of-item-similarity-matrix">Taking advantage of the symmetric property of item similarity matrix</a></li>
</ul>
</li>
<li><a href="#option-2-sequential-computation">Option 2: Sequential computation</a></li>
</ul>
</li>
<li><a href="#item-based-recommendation">Item-based recommendation</a><ul>
<li><a href="#step-1-computes-top-k-recently-purchased-items-for-each-user">Step 1: Computes top-k recently purchased items for each user</a></li>
<li><a href="#step-2-recommend-top-k-items-based-on-users-recently-purchased-items">Step 2: Recommend top-k items based on users&apos; recently purchased items</a><ul>
<li><a href="#cooccurrence-based">Cooccurrence-based</a></li>
<li><a href="#similarity-based">Similarity-based</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#efficient-similarity-computation">Efficient similarity computation</a><ul>
<li><a href="#minhash-compute-pseudo-jaccard-similarity">MinHash: Compute &quot;pseudo&quot; Jaccard similarity</a><ul>
<li><a href="#compute-approximated-cosine-similarity-by-using-the-minhash-based-jaccard-similarity">Compute approximated cosine similarity by using the MinHash-based Jaccard similarity</a></li>
</ul>
</li>
<li><a href="#dimsum-approximated-all-pairs-cosine-similarity-computation">DIMSUM: Approximated all-pairs &quot;Cosine&quot; similarity computation</a><ul>
<li><a href="#create-itemsimilarity-from-upper-triangular-matrix">Create <code>item_similarity</code> from Upper Triangular Matrix</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div><!-- tocstop -->
<div class="panel panel-warning"><div class="panel-heading"><h3 class="panel-title" id="caution"><i class="fa fa-exclamation-triangle"></i> Caution</h3></div><div class="panel-body"><p>Naive similarity computation is <code>O(n^2)</code> to compute all item-item pair similarity. In order to accelerate the procedure, Hivemall has an efficient scheme for computing Jaccard and/or cosine similarity <a href="#efficient-similarity-computation">as mentioned later</a>.</p></div></div>
<h1 id="prepare-transaction-table">Prepare <code>transaction</code> table</h1>
<p>Prepare following <code>transaction</code> table. We will generate <code>feature_vector</code> for each <code>itemid</code> based on cooccurrence of purchased items, a sort of bucket analysis.</p>
<table>
<thead>
<tr>
<th style="text-align:center">userid</th>
<th style="text-align:center">itemid</th>
<th style="text-align:center">purchase_at <code>timestamp</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">31231</td>
<td style="text-align:center">2015-04-9 00:29:02</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">13212</td>
<td style="text-align:center">2016-05-24 16:29:02</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">312</td>
<td style="text-align:center">2016-06-03 23:29:02</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">2313</td>
<td style="text-align:center">2016-06-04 19:29:02</td>
</tr>
<tr>
<td style="text-align:center">..</td>
<td style="text-align:center">..</td>
<td style="text-align:center">..</td>
</tr>
</tbody>
</table>
<h1 id="create-itemfeatures-table">Create <code>item_features</code> table</h1>
<p>What we want for creating a feature vector for each item is the following <code>cooccurrence</code> relation.</p>
<table>
<thead>
<tr>
<th style="text-align:center">itemid</th>
<th style="text-align:center">other</th>
<th style="text-align:center">cnt</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">583266</td>
<td style="text-align:center">621056</td>
<td style="text-align:center">9999</td>
</tr>
<tr>
<td style="text-align:center">583266</td>
<td style="text-align:center">583266</td>
<td style="text-align:center">18</td>
</tr>
<tr>
<td style="text-align:center">31231</td>
<td style="text-align:center">13212</td>
<td style="text-align:center">129</td>
</tr>
<tr>
<td style="text-align:center">31231</td>
<td style="text-align:center">31231</td>
<td style="text-align:center">3</td>
</tr>
<tr>
<td style="text-align:center">31231</td>
<td style="text-align:center">9833</td>
<td style="text-align:center">953</td>
</tr>
<tr>
<td style="text-align:center">...</td>
<td style="text-align:center">...</td>
<td style="text-align:center">...</td>
</tr>
</tbody>
</table>
<p>Feature vectors of each item will be as follows:</p>
<table>
<thead>
<tr>
<th style="text-align:center">itemid</th>
<th style="text-align:left">feature_vector <code>array&lt;string&gt;</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">583266</td>
<td style="text-align:left">621056:9999, 583266:18</td>
</tr>
<tr>
<td style="text-align:center">31231</td>
<td style="text-align:left">13212:129, 31231:3, 9833:953</td>
</tr>
<tr>
<td style="text-align:center">...</td>
<td style="text-align:left">...</td>
</tr>
</tbody>
</table>
<p>Note that value of feature vector should be scaled for k-NN similarity computation e.g., as follows:</p>
<table>
<thead>
<tr>
<th style="text-align:center">itemid</th>
<th style="text-align:left">feature_vector <code>array&lt;string&gt;</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">583266</td>
<td style="text-align:left">621056:<code>ln(9999+1)</code>, 583266:<code>ln(18+1)</code></td>
</tr>
<tr>
<td style="text-align:center">31231</td>
<td style="text-align:left">13212:<code>ln(129+1)</code>, 31231:<code>ln(3+1)</code>, 9833:<code>ln(953+1)</code></td>
</tr>
<tr>
<td style="text-align:center">...</td>
<td style="text-align:left">...</td>
</tr>
</tbody>
</table>
<p>The following queries results in creating the above table.</p>
<h2 id="step-1-creating-userpurchased-table">Step 1: Creating <code>user_purchased</code> table</h2>
<p>The following query creates a table that contains <code>userid</code>, <code>itemid</code>, and <code>purchased_at</code>. The table represents the last user-item contact (purchase) while the <code>transaction</code> table holds all contacts.</p>
<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> user_purchased <span class="hljs-keyword">as</span>
<span class="hljs-comment">-- INSERT OVERWRITE TABLE user_purchased</span>
<span class="hljs-keyword">select</span> 
  userid,
  itemid,
  <span class="hljs-keyword">max</span>(purchased_at) <span class="hljs-keyword">as</span> purchased_at,
  <span class="hljs-keyword">count</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">as</span> purchase_count
<span class="hljs-keyword">from</span>
  <span class="hljs-keyword">transaction</span>
<span class="hljs-comment">-- where purchased_at &lt; xxx -- divide training/testing data by time </span>
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
  userid, itemid
;
</code></pre>
<div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" id="note"><i class="fa fa-edit"></i> Note</h3></div><div class="panel-body"><p>Better to avoid too old transactions because those information would be outdated though an enough number of transactions is required for recommendation.</p></div></div>
<h2 id="step-2-creating-cooccurrence-table">Step 2: Creating <code>cooccurrence</code> table</h2>
<div class="panel panel-warning"><div class="panel-heading"><h3 class="panel-title" id="caution"><i class="fa fa-exclamation-triangle"></i> Caution</h3></div><div class="panel-body"><p>Item-item cooccurrence matrix is a symmetric matrix that has the number of total occurrence for each diagonal element. If the size of items is <code>k</code>, then the size of expected matrix is <code>k * (k - 1) / 2</code>, usually a very large one. Hence, it is better to use <a href="#step-2-2-create-cooccurrence-table-from-upper-triangular-matrix-of-cooccurrence">step 2-2</a> instead of <a href="#step-2-1-create-cooccurrence-table-directly">step 2-1</a> for creating a <code>cooccurrence</code> table where dataset is large.</p></div></div>
<h3 id="step-2-1-create-cooccurrence-table-directly">Step 2-1: Create <code>cooccurrence</code> table directly</h3>
<pre><code class="lang-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> cooccurrence <span class="hljs-keyword">as</span> 
<span class="hljs-comment">-- INSERT OVERWRITE TABLE cooccurrence</span>
<span class="hljs-keyword">select</span>
  u1.itemid,
  u2.itemid <span class="hljs-keyword">as</span> other, 
  <span class="hljs-keyword">count</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">as</span> cnt
<span class="hljs-keyword">from</span>
  user_purchased u1
  <span class="hljs-keyword">JOIN</span> user_purchased u2 <span class="hljs-keyword">ON</span> (u1.userid = u2.userid)
<span class="hljs-keyword">where</span>
  u1.itemid != u2.itemid 
  <span class="hljs-comment">-- AND u2.purchased_at &gt;= u1.purchased_at -- the other item should be purchased with/after the base item</span>
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
  u1.itemid, u2.itemid
<span class="hljs-comment">-- having -- optional but recommended to have this condition where dataset is large</span>
<span class="hljs-comment">--  cnt &gt;= 2 -- count(1) &gt;= 2</span>
;
</code></pre>
<div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" id="note"><i class="fa fa-edit"></i> Note</h3></div><div class="panel-body"><p>Note that specifying <code>having cnt &gt;= 2</code> has a drawback that item cooccurrence is not calculated where <code>cnt</code> is less than 2. It could result no recommended items for certain items. Please ignore <code>having cnt &gt;= 2</code> if the following computations finish in an acceptable/reasonable time.</p></div></div>
<p><br></p>
<div class="panel panel-warning"><div class="panel-heading"><h3 class="panel-title" id="caution"><i class="fa fa-exclamation-triangle"></i> Caution</h3></div><div class="panel-body"><p>We ignore a purchase order in the following example. It means that the occurrence counts of <code>ItemA -&gt; ItemB</code> and <code>ItemB -&gt; ItemA</code> are assumed to be same. It is sometimes not a good idea in terms of reasoning; for example, <code>Camera -&gt; SD card</code> and <code>SD card -&gt; Camera</code> need to be considered separately.</p></div></div>
<h3 id="step-2-2-create-cooccurrence-table-from-upper-triangular-matrix-of-cooccurrence">Step 2-2: Create <code>cooccurrence</code> table from Upper Triangular Matrix of cooccurrence</h3>
<p>Better to create <a href="https://en.wikipedia.org/wiki/Triangular_matrix#Description" target="_blank">Upper Triangular Matrix</a> that has <code>itemid &gt; other</code> if resulting table is very large. No need to create Upper Triangular Matrix if your Hadoop cluster can handle the following instructions without considering it.</p>
<pre><code class="lang-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> cooccurrence_upper_triangular <span class="hljs-keyword">as</span> 
<span class="hljs-comment">-- INSERT OVERWRITE TABLE cooccurrence_upper_triangular</span>
<span class="hljs-keyword">select</span>
  u1.itemid,
  u2.itemid <span class="hljs-keyword">as</span> other, 
  <span class="hljs-keyword">count</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">as</span> cnt
<span class="hljs-keyword">from</span>
  user_purchased u1
  <span class="hljs-keyword">JOIN</span> user_purchased u2 <span class="hljs-keyword">ON</span> (u1.userid = u2.userid)
<span class="hljs-keyword">where</span>
  u1.itemid &gt; u2.itemid 
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
  u1.itemid, u2.itemid
;
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> cooccurrence <span class="hljs-keyword">as</span> 
<span class="hljs-comment">-- INSERT OVERWRITE TABLE cooccurrence</span>
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> (
  <span class="hljs-keyword">select</span> itemid, other, cnt <span class="hljs-keyword">from</span> cooccurrence_upper_triangular
  <span class="hljs-keyword">UNION</span> ALL
  <span class="hljs-keyword">select</span> other <span class="hljs-keyword">as</span> itemid, itemid <span class="hljs-keyword">as</span> other, cnt <span class="hljs-keyword">from</span> cooccurrence_upper_triangular
) t;
</code></pre>
<div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" id="note"><i class="fa fa-edit"></i> Note</h3></div><div class="panel-body"><p><code>UNION ALL</code> <a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Union#LanguageManualUnion-UNIONwithinaFROMClause" target="_blank">required to be embedded</a> in Hive.</p></div></div>
<h4 id="limiting-size-of-elements-in-cooccurrenceuppertriangular">Limiting size of elements in <code>cooccurrence_upper_triangular</code></h4>
<p>Using only top-N frequently co-occurred item pairs allows you to reduce the size of <code>cooccurrence</code> table:</p>
<pre><code class="lang-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> cooccurrence_upper_triangular <span class="hljs-keyword">as</span>
<span class="hljs-keyword">WITH</span> t1 <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span>
    u1.itemid,
    u2.itemid <span class="hljs-keyword">as</span> other, 
    <span class="hljs-keyword">count</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">as</span> cnt
  <span class="hljs-keyword">from</span>
    user_purchased u1
    <span class="hljs-keyword">JOIN</span> user_purchased u2 <span class="hljs-keyword">ON</span> (u1.userid = u2.userid)
  <span class="hljs-keyword">where</span>
    u1.itemid &gt; u2.itemid 
  <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
    u1.itemid, u2.itemid
),
t2 <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span>
    each_top_k( <span class="hljs-comment">-- top 1000</span>
      <span class="hljs-number">1000</span>, itemid, cnt, 
      itemid, other, cnt
    ) <span class="hljs-keyword">as</span> (<span class="hljs-keyword">rank</span>, cmpkey, itemid, other, cnt)
  <span class="hljs-keyword">from</span> (
    <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> t1
    CLUSTER <span class="hljs-keyword">BY</span> itemid
  ) t;
)
<span class="hljs-comment">-- INSERT OVERWRITE TABLE cooccurrence_upper_triangular</span>
<span class="hljs-keyword">select</span> itemid, other, cnt
<span class="hljs-keyword">from</span> t2;
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> cooccurrence <span class="hljs-keyword">as</span> 
<span class="hljs-keyword">WITh</span> t1 <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span> itemid, other, cnt <span class="hljs-keyword">from</span> cooccurrence_upper_triangular
  <span class="hljs-keyword">UNION</span> ALL
  <span class="hljs-keyword">select</span> other <span class="hljs-keyword">as</span> itemid, itemid <span class="hljs-keyword">as</span> other, cnt <span class="hljs-keyword">from</span> cooccurrence_upper_triangular
),
t2 <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span>
    each_top_k(
      <span class="hljs-number">1000</span>, itemid, cnt,
      itemid, other, cnt
    ) <span class="hljs-keyword">as</span> (<span class="hljs-keyword">rank</span>, cmpkey, itemid, other, cnt)
  <span class="hljs-keyword">from</span> (
    <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> t1
    CLUSTER <span class="hljs-keyword">BY</span> itemid
  ) t
)
<span class="hljs-comment">-- INSERT OVERWRITE TABLE cooccurrence</span>
<span class="hljs-keyword">select</span> itemid, other, cnt
<span class="hljs-keyword">from</span> t2;
</code></pre>
<h3 id="computing-cooccurrence-ratio-optional-step">Computing cooccurrence ratio (optional step)</h3>
<p>You can optionally compute cooccurrence ratio as follows:</p>
<pre><code class="lang-sql">WITH stats as (
  <span class="hljs-keyword">select</span> 
    itemid,
    <span class="hljs-keyword">sum</span>(cnt) <span class="hljs-keyword">as</span> totalcnt
  <span class="hljs-keyword">from</span> 
    cooccurrence
  <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
    itemid
)
<span class="hljs-keyword">INSERT</span> OVERWRITE <span class="hljs-keyword">TABLE</span> cooccurrence_ratio
<span class="hljs-keyword">SELECT</span>
  l.itemid,
  l.other, 
  (l.cnt / r.totalcnt) <span class="hljs-keyword">as</span> ratio
<span class="hljs-keyword">FROM</span>
  cooccurrence l
  <span class="hljs-keyword">JOIN</span> stats r <span class="hljs-keyword">ON</span> (l.itemid = r.itemid)
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
  l.itemid, l.other
;
</code></pre>
<p><code>l.cnt / r.totalcnt</code> represents a cooccurrence ratio of range <code>[0,1]</code>.</p>
<h2 id="step-3-creating-a-feature-vector-for-each-item">Step 3: Creating a feature vector for each item</h2>
<pre><code class="lang-sql"><span class="hljs-keyword">INSERT</span> OVERWRITE <span class="hljs-keyword">TABLE</span> item_features
<span class="hljs-keyword">SELECT</span>
  itemid,
  <span class="hljs-comment">-- scaling `ln(cnt+1)` to avoid large value in the feature vector</span>
  <span class="hljs-comment">-- rounding to xxx.yyyyy to reduce size of feature_vector in array&lt;string&gt;</span>
  collect_list(feature(other, <span class="hljs-keyword">round</span>(<span class="hljs-keyword">ln</span>(cnt+<span class="hljs-number">1</span>),<span class="hljs-number">5</span>))) <span class="hljs-keyword">as</span> feature_vector
<span class="hljs-keyword">FROM</span>
  cooccurrence
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>
  itemid
;
</code></pre>
<h1 id="compute-item-similarity-scores">Compute item similarity scores</h1>
<p>Item-item similarity computation is known to be computational complexity <code>O(n^2)</code> where <code>n</code> is the number of items. We have two options to compute the similarities, and, depending on your cluster size and your dataset, the optimal solution differs. </p>
<div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" id="note"><i class="fa fa-edit"></i> Note</h3></div><div class="panel-body"><p>If your dataset is large enough, better to choose <a href="#taking-advantage-of-the-symmetric-property-of-item-similarity-matrix">modified version of option 1</a>, which utilizes the symmetric property of similarity matrix.</p></div></div>
<h2 id="option-1-parallel-computation-with-computationally-heavy-shuffling">Option 1: Parallel computation with computationally heavy shuffling</h2>
<p>This version involves 3-way joins w/ large data shuffle; However, this version works in parallel where a cluster has enough task slots.</p>
<pre><code class="lang-sql">WITH similarity as (
  <span class="hljs-keyword">select</span>
    o.itemid,
    o.other,
    cosine_similarity(t1.feature_vector, t2.feature_vector) <span class="hljs-keyword">as</span> similarity
  <span class="hljs-keyword">from</span>
    cooccurrence o
    <span class="hljs-keyword">JOIN</span> item_features t1 <span class="hljs-keyword">ON</span> (o.itemid = t1.itemid)
    <span class="hljs-keyword">JOIN</span> item_features t2 <span class="hljs-keyword">ON</span> (o.other = t2.itemid)
),
topk <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span>
    each_top_k( <span class="hljs-comment">-- get top-10 items based on similarity score</span>
      <span class="hljs-number">10</span>, itemid, similarity,
      itemid, other <span class="hljs-comment">-- output items</span>
    ) <span class="hljs-keyword">as</span> (<span class="hljs-keyword">rank</span>, similarity, itemid, other)
  <span class="hljs-keyword">from</span> (
    <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> similarity
    <span class="hljs-keyword">where</span> similarity &gt; <span class="hljs-number">0</span> <span class="hljs-comment">-- similarity &gt; 0.01</span>
    CLUSTER <span class="hljs-keyword">BY</span> itemid
  ) t
)
<span class="hljs-keyword">INSERT</span> OVERWRITE <span class="hljs-keyword">TABLE</span> item_similarity
<span class="hljs-keyword">select</span> 
  itemid, other, similarity
<span class="hljs-keyword">from</span> 
  topk;
</code></pre>
<h3 id="taking-advantage-of-the-symmetric-property-of-item-similarity-matrix">Taking advantage of the symmetric property of item similarity matrix</h3>
<p>Notice that <code>item_similarity</code> is a symmetric matrix. So, you can compute it from an upper triangular matrix as follows.</p>
<pre><code class="lang-sql">WITH cooccurrence_top100 as (
  <span class="hljs-keyword">select</span>
    each_top_k(
      <span class="hljs-number">100</span>, itemid, cnt,  
      itemid, other
    ) <span class="hljs-keyword">as</span> (<span class="hljs-keyword">rank</span>, cmpkey, itemid, other)
  <span class="hljs-keyword">from</span> (
    <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> cooccurrence_upper_triangular
    CLUSTER <span class="hljs-keyword">BY</span> itemid
  ) t
), 
similarity <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span>
    o.itemid,
    o.other,
    cosine_similarity(t1.feature_vector, t2.feature_vector) <span class="hljs-keyword">as</span> similarity
  <span class="hljs-keyword">from</span>
    cooccurrence_top100 o
    <span class="hljs-comment">-- cooccurrence_upper_triangular o</span>
    <span class="hljs-keyword">JOIN</span> item_features t1 <span class="hljs-keyword">ON</span> (o.itemid = t1.itemid)
    <span class="hljs-keyword">JOIN</span> item_features t2 <span class="hljs-keyword">ON</span> (o.other = t2.itemid)
),
topk <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span>
    each_top_k( <span class="hljs-comment">-- get top-10 items based on similarity score</span>
      <span class="hljs-number">10</span>, itemid, similarity,
      itemid, other <span class="hljs-comment">-- output items</span>
    ) <span class="hljs-keyword">as</span> (<span class="hljs-keyword">rank</span>, similarity, itemid, other)
  <span class="hljs-keyword">from</span> (
    <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> similarity
    <span class="hljs-keyword">where</span> similarity &gt; <span class="hljs-number">0</span> <span class="hljs-comment">-- similarity &gt; 0.01</span>
    CLUSTER <span class="hljs-keyword">BY</span> itemid
  ) t
)
<span class="hljs-keyword">INSERT</span> OVERWRITE <span class="hljs-keyword">TABLE</span> item_similarity_upper_triangler
<span class="hljs-keyword">select</span> 
  itemid, other, similarity
<span class="hljs-keyword">from</span> 
  topk;
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">INSERT</span> OVERWRITE <span class="hljs-keyword">TABLE</span> item_similarity
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> (
  <span class="hljs-keyword">select</span> itemid, other, similarity <span class="hljs-keyword">from</span> item_similarity_upper_triangler
  <span class="hljs-keyword">UNION</span> ALL
  <span class="hljs-keyword">select</span> other <span class="hljs-keyword">as</span> itemid, itemid <span class="hljs-keyword">as</span> other, similarity <span class="hljs-keyword">from</span> item_similarity_upper_triangler
) t;
</code></pre>
<h2 id="option-2-sequential-computation">Option 2: Sequential computation</h2>
<p>Alternatively, you can compute cosine similarity as follows. This version involves cross join and thus runs sequentially in a single task. However, it involves less shuffle compared to option 1.</p>
<pre><code class="lang-sql">WITH similarity as (
  <span class="hljs-keyword">select</span>
   t1.itemid,
   t2.itemid <span class="hljs-keyword">as</span> other,
   cosine_similarity(t1.feature_vector, t2.feature_vector) <span class="hljs-keyword">as</span> similarity
  <span class="hljs-keyword">from</span>
   item_features t1
   <span class="hljs-keyword">CROSS</span> <span class="hljs-keyword">JOIN</span> item_features t2
  <span class="hljs-keyword">WHERE</span>
    t1.itemid != t2.itemid
),
topk <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span>
    each_top_k( <span class="hljs-comment">-- get top-10 items based on similarity score</span>
      <span class="hljs-number">10</span>, itemid, similarity,
      itemid, other <span class="hljs-comment">-- output items</span>
    ) <span class="hljs-keyword">as</span> (<span class="hljs-keyword">rank</span>, similarity, itemid, other)
  <span class="hljs-keyword">from</span> (
    <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> similarity
    <span class="hljs-keyword">where</span> similarity &gt; <span class="hljs-number">0</span> <span class="hljs-comment">-- similarity &gt; 0.01</span>
    CLUSTER <span class="hljs-keyword">BY</span> itemid
  ) t
)
<span class="hljs-keyword">INSERT</span> OVERWRITE <span class="hljs-keyword">TABLE</span> item_similarity
<span class="hljs-keyword">select</span> 
  itemid, other, similarity
<span class="hljs-keyword">from</span> 
  topk
;
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:center">item</th>
<th style="text-align:center">other</th>
<th style="text-align:center">similarity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">583266</td>
<td style="text-align:center">621056</td>
<td style="text-align:center">0.33</td>
</tr>
<tr>
<td style="text-align:center">583266</td>
<td style="text-align:center">583266</td>
<td style="text-align:center">0.18</td>
</tr>
<tr>
<td style="text-align:center">31231</td>
<td style="text-align:center">13212</td>
<td style="text-align:center">1.29</td>
</tr>
<tr>
<td style="text-align:center">31231</td>
<td style="text-align:center">31231</td>
<td style="text-align:center">0.3</td>
</tr>
<tr>
<td style="text-align:center">31231</td>
<td style="text-align:center">9833</td>
<td style="text-align:center">0.953</td>
</tr>
<tr>
<td style="text-align:center">...</td>
<td style="text-align:center">...</td>
<td style="text-align:center">...</td>
</tr>
</tbody>
</table>
<h1 id="item-based-recommendation">Item-based recommendation</h1>
<p>This section introduces item-based recommendation based on recently purchased items by each user.</p>
<div class="panel panel-warning"><div class="panel-heading"><h3 class="panel-title" id="caution"><i class="fa fa-exclamation-triangle"></i> Caution</h3></div><div class="panel-body"><p>It would better to ignore recommending some of items that user already purchased (only 1 time) while items that are purchased twice or more would be okey to be included in the recommendation list (e.g., repeatedly purchased daily necessities). So, you would need an item property table showing that each item is repeatedly purchased items or not.</p></div></div>
<h2 id="step-1-computes-top-k-recently-purchased-items-for-each-user">Step 1: Computes top-k recently purchased items for each user</h2>
<p>First, prepare <code>recently_purchased_items</code> table as follows:</p>
<pre><code class="lang-sql"><span class="hljs-keyword">INSERT</span> OVERWRITE <span class="hljs-keyword">TABLE</span> recently_purchased_items
<span class="hljs-keyword">select</span>
  each_top_k( <span class="hljs-comment">-- get top-5 recently purchased items for each user</span>
     <span class="hljs-number">5</span>, userid, purchased_at,
     userid, itemid
  ) <span class="hljs-keyword">as</span> (<span class="hljs-keyword">rank</span>, purchased_at, userid, itemid)
<span class="hljs-keyword">from</span> (
  <span class="hljs-keyword">select</span>
    purchased_at, userid, itemid
  <span class="hljs-keyword">from</span> 
    user_purchased
  <span class="hljs-comment">-- where [optional filtering]</span>
  <span class="hljs-comment">--  purchased_at &gt;= xxx -- divide training/test data by time</span>
  CLUSTER <span class="hljs-keyword">BY</span>
    user_id <span class="hljs-comment">-- Note CLUSTER BY is mandatory when using each_top_k</span>
) t;
</code></pre>
<h2 id="step-2-recommend-top-k-items-based-on-users-recently-purchased-items">Step 2: Recommend top-k items based on users&apos; recently purchased items</h2>
<p>In order to generate a list of recommended items, you can use either cooccurrence count or similarity as a relevance score.</p>
<div class="panel panel-warning"><div class="panel-heading"><h3 class="panel-title" id="caution"><i class="fa fa-exclamation-triangle"></i> Caution</h3></div><div class="panel-body"><p>In order to obtain ranked list of items, this section introduces queries using <code>map_values(to_ordered_map(rank, rec_item))</code>. However, this kind of usage has a potential issue that multiple <code>rec_item</code>-s which have the exactly same <code>rank</code> will be aggregated to single arbitrary <code>rec_item</code>, because <code>to_ordered_map()</code> creates a key-value map which uses duplicated <code>rank</code> as key.</p><p>Since such situation is possible in case that <code>each_top_k()</code> is executed for different <code>userid</code>-s who have the same <code>cnt</code> or <code>similarity</code>, we recommend you to use <code>to_ordered_list(rec_item, rank, &apos;-reverse&apos;)</code> instead of <code>map_values(to_ordered_map(rank, rec_item, true))</code>. The alternative approach is available from Hivemall v0.5-rc.1 or later.</p></div></div>
<h3 id="cooccurrence-based">Cooccurrence-based</h3>
<pre><code class="lang-sql">WITH topk as (
  <span class="hljs-keyword">select</span>
    each_top_k(
       <span class="hljs-number">5</span>, userid, cnt,
       userid, other
    ) <span class="hljs-keyword">as</span> (<span class="hljs-keyword">rank</span>, cnt, userid, rec_item)
  <span class="hljs-keyword">from</span> (
    <span class="hljs-keyword">select</span> 
      t1.userid, t2.other, <span class="hljs-keyword">max</span>(t2.cnt) <span class="hljs-keyword">as</span> cnt
    <span class="hljs-keyword">from</span>
      recently_purchased_items t1
      <span class="hljs-keyword">JOIN</span> cooccurrence t2 <span class="hljs-keyword">ON</span> (t1.itemid = t2.itemid)
    <span class="hljs-keyword">where</span>
      t1.itemid != t2.other <span class="hljs-comment">-- do not include items that user already purchased</span>
      <span class="hljs-keyword">AND</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> (
        <span class="hljs-keyword">SELECT</span> a.itemid <span class="hljs-keyword">FROM</span> user_purchased a
        <span class="hljs-keyword">WHERE</span> a.userid = t1.userid <span class="hljs-keyword">AND</span> a.itemid = t2.other
<span class="hljs-comment">--        AND a.purchased_count &lt;= 1 -- optional</span>
      )
    <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
      t1.userid, t2.other
    CLUSTER <span class="hljs-keyword">BY</span>
      userid <span class="hljs-comment">-- top-k grouping by userid</span>
  ) t1
)
<span class="hljs-keyword">INSERT</span> OVERWRITE <span class="hljs-keyword">TABLE</span> item_recommendation
<span class="hljs-keyword">select</span>
  userid,
  map_values(to_ordered_map(<span class="hljs-keyword">rank</span>, rec_item)) <span class="hljs-keyword">as</span> rec_items
<span class="hljs-keyword">from</span>
  topk
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
  userid
;
</code></pre>
<h3 id="similarity-based">Similarity-based</h3>
<pre><code class="lang-sql">WITH topk as (
  <span class="hljs-keyword">select</span>
    each_top_k(
       <span class="hljs-number">5</span>, userid, similarity,
       userid, other
    ) <span class="hljs-keyword">as</span> (<span class="hljs-keyword">rank</span>, similarity, userid, rec_item)
  <span class="hljs-keyword">from</span> (
    <span class="hljs-keyword">select</span>
      t1.userid, t2.other, <span class="hljs-keyword">max</span>(t2.similarity) <span class="hljs-keyword">as</span> similarity
    <span class="hljs-keyword">from</span>
      recently_purchased_items t1
      <span class="hljs-keyword">JOIN</span> item_similarity t2 <span class="hljs-keyword">ON</span> (t1.itemid = t2.itemid)
    <span class="hljs-keyword">where</span>
      t1.itemid != t2.other <span class="hljs-comment">-- do not include items that user already purchased</span>
      <span class="hljs-keyword">AND</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> (
        <span class="hljs-keyword">SELECT</span> a.itemid <span class="hljs-keyword">FROM</span> user_purchased a
        <span class="hljs-keyword">WHERE</span> a.userid = t1.userid <span class="hljs-keyword">AND</span> a.itemid = t2.other
<span class="hljs-comment">--        AND a.purchased_count &lt;= 1 -- optional</span>
      )
    <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
      t1.userid, t2.other
    CLUSTER <span class="hljs-keyword">BY</span>
      userid <span class="hljs-comment">-- top-k grouping by userid</span>
  ) t1
)
<span class="hljs-keyword">INSERT</span> OVERWRITE <span class="hljs-keyword">TABLE</span> item_recommendation
<span class="hljs-keyword">select</span>
  userid,
  map_values(to_ordered_map(<span class="hljs-keyword">rank</span>, rec_item)) <span class="hljs-keyword">as</span> rec_items
<span class="hljs-keyword">from</span>
  topk
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
  userid
;
</code></pre>
<h1 id="efficient-similarity-computation">Efficient similarity computation</h1>
<p>Since naive similarity computation takes <code>O(n^2)</code> computational complexity, utilizing a certain approximation scheme is practically important to improve efficiency and feasibility. In particular, Hivemall enables you to use one of two sophisticated approximation schemes, <a href="##minhash-compute-pseudo-jaccard-similarity">MinHash</a> and <a href="#dimsum-approximated-all-pairs-cosine-similarity-computation">DIMSUM</a>.</p>
<h2 id="minhash-compute-pseudo-jaccard-similarity">MinHash: Compute &quot;pseudo&quot; Jaccard similarity</h2>
<p>Refer <a href="https://en.wikipedia.org/wiki/MinHash#Jaccard_similarity_and_minimum_hash_values" target="_blank">this article</a> to get details about MinHash and Jarccard similarity. <a href="https://blog.treasuredata.com/blog/2016/02/16/minhash-in-hivemall/" target="_blank">This blog article</a> also explains about Hivemall&apos;s minhash.</p>
<pre><code class="lang-sql"><span class="hljs-keyword">INSERT</span> OVERWRITE <span class="hljs-keyword">TABLE</span> minhash <span class="hljs-comment">-- results in 30x records of item_features</span>
<span class="hljs-keyword">select</span>  
  <span class="hljs-comment">-- assign 30 minhash values for each item</span>
  minhash(itemid, feature_vector, <span class="hljs-string">&quot;-n 30&quot;</span>) <span class="hljs-keyword">as</span> (clusterid, itemid) <span class="hljs-comment">-- &apos;-n&apos; would be 10~100</span>
<span class="hljs-keyword">from</span>
  item_features
;

WITH t1 as (
  <span class="hljs-keyword">select</span>
    l.itemid,
    r.itemid <span class="hljs-keyword">as</span> other,
    <span class="hljs-keyword">count</span>(<span class="hljs-number">1</span>) / <span class="hljs-number">30</span> <span class="hljs-keyword">as</span> similarity <span class="hljs-comment">-- Pseudo jaccard similarity &apos;-n 30&apos;</span>
  <span class="hljs-keyword">from</span>
    minhash l 
    <span class="hljs-keyword">JOIN</span> minhash r 
      <span class="hljs-keyword">ON</span> (l.clusterid = r.clusterid)
  <span class="hljs-keyword">where</span> 
    l.itemid != r.itemid
  <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
    l.itemid, r.itemid
  <span class="hljs-keyword">having</span>
    <span class="hljs-keyword">count</span>(<span class="hljs-number">1</span>) &gt;= <span class="hljs-number">3</span> <span class="hljs-comment">-- [optional] filtering equals to (count(1)/30) &gt;= 0.1</span>
),
top100 <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span>
    each_top_k(<span class="hljs-number">100</span>, itemid, similarity, itemid, other)
      <span class="hljs-keyword">as</span> (<span class="hljs-keyword">rank</span>, similarity, itemid, other)
  <span class="hljs-keyword">from</span> (
    <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> t1 
    <span class="hljs-comment">-- where similarity &gt;= 0.1 -- Optional filtering. Can be ignored.</span>
    CLUSTER <span class="hljs-keyword">BY</span> itemid 
  ) t2
)
<span class="hljs-keyword">INSERT</span> OVERWRITE <span class="hljs-keyword">TABLE</span> jaccard_similarity
<span class="hljs-keyword">select</span>
  itemid, other, similarity
<span class="hljs-keyword">from</span>
  top100
;
</code></pre>
<div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" id="note"><i class="fa fa-edit"></i> Note</h3></div><div class="panel-body"><p>There might be no similar item for certain items.</p></div></div>
<h3 id="compute-approximated-cosine-similarity-by-using-the-minhash-based-jaccard-similarity">Compute approximated cosine similarity by using the MinHash-based Jaccard similarity</h3>
<p>Once the MinHash-based approach found rough <code>top-N</code> similar items, you can efficiently find <code>top-k</code> similar items in terms of cosine similarity, where <code>k &lt;&lt; N</code> (e.g., k=10 and N=100).</p>
<pre><code class="lang-sql">WITH similarity as (
  <span class="hljs-keyword">select</span>
    o.itemid,
    o.other,
    cosine_similarity(t1.feature_vector, t2.feature_vector) <span class="hljs-keyword">as</span> similarity
  <span class="hljs-keyword">from</span>
    jaccard_similarity o
    <span class="hljs-keyword">JOIN</span> item_features t1 <span class="hljs-keyword">ON</span> (o.itemid = t1.itemid)
    <span class="hljs-keyword">JOIN</span> item_features t2 <span class="hljs-keyword">ON</span> (o.other = t2.itemid)
),
topk <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span>
    each_top_k( <span class="hljs-comment">-- get top-10 items based on similarity score</span>
      <span class="hljs-number">10</span>, itemid, similarity,
      itemid, other <span class="hljs-comment">-- output items</span>
    ) <span class="hljs-keyword">as</span> (<span class="hljs-keyword">rank</span>, similarity, itemid, other)
  <span class="hljs-keyword">from</span> (
    <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> similarity
    <span class="hljs-keyword">where</span> similarity &gt; <span class="hljs-number">0</span> <span class="hljs-comment">-- similarity &gt; 0.01</span>
    CLUSTER <span class="hljs-keyword">BY</span> itemid
  ) t
)
<span class="hljs-keyword">INSERT</span> OVERWRITE <span class="hljs-keyword">TABLE</span> cosine_similarity
<span class="hljs-keyword">select</span> 
  itemid, other, similarity
<span class="hljs-keyword">from</span> 
  topk;
</code></pre>
<h2 id="dimsum-approximated-all-pairs-cosine-similarity-computation">DIMSUM: Approximated all-pairs &quot;Cosine&quot; similarity computation</h2>
<div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" id="note"><i class="fa fa-edit"></i> Note</h3></div><div class="panel-body"><p>This feature is supported from Hivemall v0.5-rc.1 or later.</p></div></div>
<p>DIMSUM is a technique to efficiently and approximately compute <a href="https://en.wikipedia.org/wiki/Cosine_similarity" target="_blank">Cosine similarities</a> for all-pairs of items. You can refer to <a href="https://blog.twitter.com/engineering/en_us/a/2014/all-pairs-similarity-via-dimsum.html" target="_blank">an article in Twitter&apos;s Engineering blog</a> to learn how DIMSUM reduces running time.</p>
<p>Here, let us begin with the <code>user_purchased</code> table. <code>item_similarity</code> table can be obtained as follows:</p>
<pre><code class="lang-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> item_similarity <span class="hljs-keyword">as</span>
<span class="hljs-keyword">with</span> item_magnitude <span class="hljs-keyword">as</span> ( <span class="hljs-comment">-- compute magnitude of each item vector</span>
  <span class="hljs-keyword">select</span>
    to_map(j, mag) <span class="hljs-keyword">as</span> mags
  <span class="hljs-keyword">from</span> (
    <span class="hljs-keyword">select</span> 
      itemid <span class="hljs-keyword">as</span> j,
      l2_norm(<span class="hljs-keyword">ln</span>(purchase_count+<span class="hljs-number">1</span>)) <span class="hljs-keyword">as</span> mag <span class="hljs-comment">-- use scaled value</span>
    <span class="hljs-keyword">from</span> 
      user_purchased
    <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
      itemid
  ) t0
),
item_features <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span>
    userid <span class="hljs-keyword">as</span> i,
    collect_list(
      feature(itemid, <span class="hljs-keyword">ln</span>(purchase_count+<span class="hljs-number">1</span>)) <span class="hljs-comment">-- use scaled value</span>
    ) <span class="hljs-keyword">as</span> feature_vector
  <span class="hljs-keyword">from</span>
    user_purchased
  <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
    userid
),
partial_result <span class="hljs-keyword">as</span> ( <span class="hljs-comment">-- launch DIMSUM in a MapReduce fashion</span>
  <span class="hljs-keyword">select</span>
    dimsum_mapper(f.feature_vector, m.mags, <span class="hljs-string">&apos;-threshold 0.5&apos;</span>)
      <span class="hljs-keyword">as</span> (itemid, other, s)
  <span class="hljs-keyword">from</span>
    item_features f
  <span class="hljs-keyword">left</span> <span class="hljs-keyword">outer</span> <span class="hljs-keyword">join</span> item_magnitude m
),
similarity <span class="hljs-keyword">as</span> (
  <span class="hljs-comment">-- reduce (i.e., sum up) mappers&apos; partial results</span>
  <span class="hljs-keyword">select</span>
    itemid, 
    other,
    <span class="hljs-keyword">sum</span>(s) <span class="hljs-keyword">as</span> similarity
  <span class="hljs-keyword">from</span> 
    partial_result
  <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
    itemid, other
),
topk <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span>
    each_top_k( <span class="hljs-comment">-- get top-10 items based on similarity score</span>
      <span class="hljs-number">10</span>, itemid, similarity,
      itemid, other <span class="hljs-comment">-- output items</span>
    ) <span class="hljs-keyword">as</span> (<span class="hljs-keyword">rank</span>, similarity, itemid, other)
  <span class="hljs-keyword">from</span> (
    <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> similarity
    CLUSTER <span class="hljs-keyword">BY</span> itemid
  ) t
)
<span class="hljs-comment">-- insert overwrite table item_similarity</span>
<span class="hljs-keyword">select</span> 
  itemid, other, similarity
<span class="hljs-keyword">from</span> 
  topk
;
</code></pre>
<p>Ultimately, using <code>item_similarity</code> for <a href="#item-based-recommendation">item-based recommendation</a> is straightforward in a similar way to what we explained above.</p>
<p>In the above query, an important part is obviously <code>dimsum_mapper(f.feature_vector, m.mags, &apos;-threshold 0.5&apos;)</code>. An option <code>-threshold</code> is a real value in <code>[0, 1)</code> range, and intuitively it illustrates <em>&quot;similarities above this threshold are approximated by the DIMSUM algorithm&quot;</em>.</p>
<h3 id="create-itemsimilarity-from-upper-triangular-matrix">Create <code>item_similarity</code> from Upper Triangular Matrix</h3>
<p>Thanks to the symmetric property of similarity matrix, DIMSUM enables you to utilize space-efficient Upper-Triangular-Matrix-style output by just adding an option <code>-disable_symmetric_output</code>:</p>
<pre><code class="lang-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> item_similarity <span class="hljs-keyword">as</span>
<span class="hljs-keyword">with</span> item_magnitude <span class="hljs-keyword">as</span> (
  ...
),
partial_result <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span>
    dimsum_mapper(f.feature_vector, m.mags, <span class="hljs-string">&apos;-threshold 0.5 -disable_symmetric_output&apos;</span>)
      <span class="hljs-keyword">as</span> (itemid, other, s)
  <span class="hljs-keyword">from</span>
    item_features f
  <span class="hljs-keyword">left</span> <span class="hljs-keyword">outer</span> <span class="hljs-keyword">join</span> item_magnitude m
),
similarity_upper_triangular <span class="hljs-keyword">as</span> (
  <span class="hljs-comment">-- if similarity of (i1, i2) pair is in this table, (i2, i1)&apos;s similarity is omitted</span>
  <span class="hljs-keyword">select</span>
    itemid, 
    other,
    <span class="hljs-keyword">sum</span>(s) <span class="hljs-keyword">as</span> similarity
  <span class="hljs-keyword">from</span> 
    partial_result
  <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>
    itemid, other
),
similarity <span class="hljs-keyword">as</span> ( <span class="hljs-comment">-- copy (i1, i2)&apos;s similarity as (i2, i1)&apos;s one</span>
  <span class="hljs-keyword">select</span> itemid, other, similarity <span class="hljs-keyword">from</span> similarity_upper_triangular
  <span class="hljs-keyword">union</span> all
  <span class="hljs-keyword">select</span> other <span class="hljs-keyword">as</span> itemid, itemid <span class="hljs-keyword">as</span> other, similarity <span class="hljs-keyword">from</span> similarity_upper_triangular
),
topk <span class="hljs-keyword">as</span> (
  ...
</code></pre>
<p><div id="page-footer" class="localized-footer"><hr><!--
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing,
  software distributed under the License is distributed on an
  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, either express or implied.  See the License for the
  specific language governing permissions and limitations
  under the License.
-->
<p><sub><font color="gray">
Apache Hivemall is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator.
</font></sub></p>
</div></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            

        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Item-based Collaborative Filtering","level":"9.1.1","depth":2,"next":{"title":"News20 Related Article Recommendation Tutorial","level":"9.2","depth":1,"path":"recommend/news20.md","ref":"recommend/news20.md","articles":[{"title":"Data Preparation","level":"9.2.1","depth":2,"path":"multiclass/news20_dataset.md","ref":"multiclass/news20_dataset.md","articles":[]},{"title":"LSH/MinHash and Jaccard Similarity","level":"9.2.2","depth":2,"path":"recommend/news20_jaccard.md","ref":"recommend/news20_jaccard.md","articles":[]},{"title":"LSH/MinHash and Brute-force Search","level":"9.2.3","depth":2,"path":"recommend/news20_knn.md","ref":"recommend/news20_knn.md","articles":[]},{"title":"kNN search using b-Bits MinHash","level":"9.2.4","depth":2,"path":"recommend/news20_bbit_minhash.md","ref":"recommend/news20_bbit_minhash.md","articles":[]}]},"previous":{"title":"Collaborative Filtering","level":"9.1","depth":1,"path":"recommend/cf.md","ref":"recommend/cf.md","articles":[{"title":"Item-based Collaborative Filtering","level":"9.1.1","depth":2,"path":"recommend/item_based_cf.md","ref":"recommend/item_based_cf.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["theme-api","edit-link","github","splitter","sitemap","etoc","callouts","toggle-chapters","anchorjs","codeblock-filename","expandable-chapters","multipart","codeblock-filename","katex","emphasize","localized-footer"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"emphasize":{},"callouts":{},"etoc":{"h2lb":3,"header":1,"maxdepth":3,"mindepth":1,"notoc":true},"github":{"url":"https://github.com/apache/incubator-hivemall/"},"splitter":{},"search":{},"downloadpdf":{"base":"https://github.com/apache/incubator-hivemall/docs/gitbook","label":"PDF","multilingual":false},"multipart":{},"localized-footer":{"filename":"FOOTER.md","hline":"true"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2,"font":"sans"},"highlight":{},"codeblock-filename":{},"sitemap":{"hostname":"https://hivemall.incubator.apache.org/"},"theme-api":{"languages":[],"split":false,"theme":"dark"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit","base":"https://github.com/apache/incubator-hivemall/tree/master/docs/gitbook"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":true},"anchorjs":{"selector":"h1,h2,h3,*:not(.callout) > h4,h5"},"toggle-chapters":{},"expandable-chapters":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Hivemall User Manual","links":{"sidebar":{"<i class=\"fa fa-home\"></i> Home":"https://hivemall.incubator.apache.org/"}},"gitbook":"3.x.x","description":"User Manual for Apache Hivemall"},"file":{"path":"recommend/item_based_cf.md","mtime":"2019-03-13T08:32:16.821Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-07-26T07:34:33.544Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-etoc/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-toggle-chapters/toggle.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-anchorjs/anchor.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-anchorjs/anchor-style.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-api/theme-api.js"></script>
        
    

    </body>
</html>

